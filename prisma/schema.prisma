generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Empresa {
  id             String               @id @db.VarChar(255)
  cnpj           String               @unique @db.VarChar(255)
  nome_fantasia  String               @db.VarChar(255)
  razao_social   String               @db.VarChar(255)
  proprietarioId String               @db.VarChar(255)
  Proprietario   Proprietario         @relation(fields: [proprietarioId], references: [id])
  produto        Produto[]
  colaboradores  EmpresaColaborador[]
  endereco       Endereco[]

  @@index([proprietarioId], map: "Empresa_proprietarioId_fkey")
}

model Proprietario {
  id            String               @id @db.VarChar(255)
  nome          String               @db.VarChar(255)
  sobrenome     String               @db.VarChar(255)
  email         String               @unique @db.VarChar(255)
  senha         String               @db.VarChar(255)
  data_cadastro DateTime             @default(now()) @db.Timestamp(0)
  cpf           String               @unique @db.VarChar(255)
  empresa       Empresa[]
  colaboradres  EmpresaColaborador[]
}

model EmpresaColaborador {
  colaborador   Proprietario @relation(fields: [colaboradorId], references: [id])
  colaboradorId String
  empresaId     String
  empresa       Empresa      @relation(fields: [empresaId], references: [id])
  admin         Boolean?     @default(false)

  @@id([colaboradorId, empresaId])
}

model Endereco {
  id        Int      @id @default(autoincrement())
  cep       String   @db.VarChar(255)
  uf        String   @db.Char(2)
  bairro    String   @db.VarChar(255)
  rua       String   @db.VarChar(255)
  num       String   @db.VarChar(255)
  refer     String?  @db.VarChar(255)
  Empresa   Empresa? @relation(fields: [empresaId], references: [id])
  empresaId String?  @db.VarChar(255)
  cidadeId  String
  cidade    Cidade   @relation(fields: [cidadeId], references: [id])
}

model Cidade {
  id       String     @id @default(uuid())
  nome     String
  endereco Endereco[]
}

model Produto {
  id          String    @id @db.VarChar(255)
  nome        String    @db.VarChar(255)
  descricao   String    @db.Text
  ncm         String    @db.VarChar(255)
  empresaId   String
  empresa     Empresa?  @relation(fields: [empresaId], references: [id])
  categoriaId String
  categoria   Categoria @relation(fields: [categoriaId], references: [id])
}

model Categoria {
  id       String    @id
  desc     String
  produtos Produto[]
}
